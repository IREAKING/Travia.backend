// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: blog.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const approveComment = `-- name: ApproveComment :one
UPDATE binh_luan_blog
SET 
    da_duyet = TRUE,
    ngay_cap_nhat = NOW()
WHERE id = $1
RETURNING id, blog_id, nguoi_dung_id, noi_dung, binh_luan_cha_id, da_duyet, ngay_tao, ngay_cap_nhat
`

func (q *Queries) ApproveComment(ctx context.Context, id int32) (BinhLuanBlog, error) {
	row := q.db.QueryRow(ctx, approveComment, id)
	var i BinhLuanBlog
	err := row.Scan(
		&i.ID,
		&i.BlogID,
		&i.NguoiDungID,
		&i.NoiDung,
		&i.BinhLuanChaID,
		&i.DaDuyet,
		&i.NgayTao,
		&i.NgayCapNhat,
	)
	return i, err
}

const countBlogComments = `-- name: CountBlogComments :one
SELECT COUNT(*) FROM binh_luan_blog
WHERE blog_id = $1
    AND da_duyet = TRUE
`

func (q *Queries) CountBlogComments(ctx context.Context, blogID int32) (int64, error) {
	row := q.db.QueryRow(ctx, countBlogComments, blogID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countBlogs = `-- name: CountBlogs :one
SELECT COUNT(*) FROM blog
WHERE ($1::text IS NULL OR trang_thai = $1::text)
    AND ($2::text IS NULL OR danh_muc = $2::text)
    AND ($3::text IS NULL OR tac_gia_id::text = $3::text)
`

type CountBlogsParams struct {
	Column1 string `json:"column_1"`
	Column2 string `json:"column_2"`
	Column3 string `json:"column_3"`
}

func (q *Queries) CountBlogs(ctx context.Context, arg CountBlogsParams) (int64, error) {
	row := q.db.QueryRow(ctx, countBlogs, arg.Column1, arg.Column2, arg.Column3)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countPublishedBlogs = `-- name: CountPublishedBlogs :one
SELECT COUNT(*) FROM blog
WHERE trang_thai = 'cong_bo'
    AND (ngay_dang IS NULL OR ngay_dang <= NOW())
`

func (q *Queries) CountPublishedBlogs(ctx context.Context) (int64, error) {
	row := q.db.QueryRow(ctx, countPublishedBlogs)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createBlog = `-- name: CreateBlog :one

INSERT INTO blog (
    tieu_de,
    slug,
    tom_tat,
    noi_dung,
    anh_dai_dien,
    tac_gia_id,
    danh_muc,
    tu_khoa,
    trang_thai,
    noi_bat,
    ngay_dang
) VALUES (
    $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11
) RETURNING id, tieu_de, slug, tom_tat, noi_dung, anh_dai_dien, tac_gia_id, danh_muc, tu_khoa, luot_xem, luot_thich, trang_thai, noi_bat, ngay_dang, ngay_tao, ngay_cap_nhat
`

type CreateBlogParams struct {
	TieuDe     string           `json:"tieu_de"`
	Slug       string           `json:"slug"`
	TomTat     *string          `json:"tom_tat"`
	NoiDung    string           `json:"noi_dung"`
	AnhDaiDien *string          `json:"anh_dai_dien"`
	TacGiaID   pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc    *string          `json:"danh_muc"`
	TuKhoa     []string         `json:"tu_khoa"`
	TrangThai  *string          `json:"trang_thai"`
	NoiBat     *bool            `json:"noi_bat"`
	NgayDang   pgtype.Timestamp `json:"ngay_dang"`
}

// ===========================================
// BLOG QUERIES
// ===========================================
func (q *Queries) CreateBlog(ctx context.Context, arg CreateBlogParams) (Blog, error) {
	row := q.db.QueryRow(ctx, createBlog,
		arg.TieuDe,
		arg.Slug,
		arg.TomTat,
		arg.NoiDung,
		arg.AnhDaiDien,
		arg.TacGiaID,
		arg.DanhMuc,
		arg.TuKhoa,
		arg.TrangThai,
		arg.NoiBat,
		arg.NgayDang,
	)
	var i Blog
	err := row.Scan(
		&i.ID,
		&i.TieuDe,
		&i.Slug,
		&i.TomTat,
		&i.NoiDung,
		&i.AnhDaiDien,
		&i.TacGiaID,
		&i.DanhMuc,
		&i.TuKhoa,
		&i.LuotXem,
		&i.LuotThich,
		&i.TrangThai,
		&i.NoiBat,
		&i.NgayDang,
		&i.NgayTao,
		&i.NgayCapNhat,
	)
	return i, err
}

const createBlogAIHistory = `-- name: CreateBlogAIHistory :one

INSERT INTO lich_su_ai_blog (
    blog_id,
    prompt,
    phan_hoi_ai,
    mo_hinh_ai,
    so_luong_token
) VALUES (
    $1, $2, $3, $4, $5
) RETURNING id, blog_id, prompt, phan_hoi_ai, mo_hinh_ai, so_luong_token, ngay_tao
`

type CreateBlogAIHistoryParams struct {
	BlogID       *int32  `json:"blog_id"`
	Prompt       string  `json:"prompt"`
	PhanHoiAi    *string `json:"phan_hoi_ai"`
	MoHinhAi     *string `json:"mo_hinh_ai"`
	SoLuongToken *int32  `json:"so_luong_token"`
}

// ===========================================
// BLOG AI HISTORY QUERIES
// ===========================================
func (q *Queries) CreateBlogAIHistory(ctx context.Context, arg CreateBlogAIHistoryParams) (LichSuAiBlog, error) {
	row := q.db.QueryRow(ctx, createBlogAIHistory,
		arg.BlogID,
		arg.Prompt,
		arg.PhanHoiAi,
		arg.MoHinhAi,
		arg.SoLuongToken,
	)
	var i LichSuAiBlog
	err := row.Scan(
		&i.ID,
		&i.BlogID,
		&i.Prompt,
		&i.PhanHoiAi,
		&i.MoHinhAi,
		&i.SoLuongToken,
		&i.NgayTao,
	)
	return i, err
}

const createBlogComment = `-- name: CreateBlogComment :one

INSERT INTO binh_luan_blog (
    blog_id,
    nguoi_dung_id,
    noi_dung,
    binh_luan_cha_id,
    da_duyet
) VALUES (
    $1, $2, $3, $4, $5
) RETURNING id, blog_id, nguoi_dung_id, noi_dung, binh_luan_cha_id, da_duyet, ngay_tao, ngay_cap_nhat
`

type CreateBlogCommentParams struct {
	BlogID        int32       `json:"blog_id"`
	NguoiDungID   pgtype.UUID `json:"nguoi_dung_id"`
	NoiDung       string      `json:"noi_dung"`
	BinhLuanChaID *int32      `json:"binh_luan_cha_id"`
	DaDuyet       *bool       `json:"da_duyet"`
}

// ===========================================
// BLOG COMMENT QUERIES
// ===========================================
func (q *Queries) CreateBlogComment(ctx context.Context, arg CreateBlogCommentParams) (BinhLuanBlog, error) {
	row := q.db.QueryRow(ctx, createBlogComment,
		arg.BlogID,
		arg.NguoiDungID,
		arg.NoiDung,
		arg.BinhLuanChaID,
		arg.DaDuyet,
	)
	var i BinhLuanBlog
	err := row.Scan(
		&i.ID,
		&i.BlogID,
		&i.NguoiDungID,
		&i.NoiDung,
		&i.BinhLuanChaID,
		&i.DaDuyet,
		&i.NgayTao,
		&i.NgayCapNhat,
	)
	return i, err
}

const decrementBlogLikes = `-- name: DecrementBlogLikes :exec
UPDATE blog
SET luot_thich = GREATEST(0, luot_thich - 1)
WHERE id = $1
`

func (q *Queries) DecrementBlogLikes(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, decrementBlogLikes, id)
	return err
}

const deleteBlog = `-- name: DeleteBlog :exec
DELETE FROM blog WHERE id = $1
`

func (q *Queries) DeleteBlog(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, deleteBlog, id)
	return err
}

const deleteComment = `-- name: DeleteComment :exec
DELETE FROM binh_luan_blog WHERE id = $1
`

func (q *Queries) DeleteComment(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, deleteComment, id)
	return err
}

const getAllBlogs = `-- name: GetAllBlogs :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
ORDER BY 
    CASE WHEN b.noi_bat = TRUE THEN 0 ELSE 1 END,
    COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $1 OFFSET $2
`

type GetAllBlogsParams struct {
	Limit  int32 `json:"limit"`
	Offset int32 `json:"offset"`
}

type GetAllBlogsRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetAllBlogs(ctx context.Context, arg GetAllBlogsParams) ([]GetAllBlogsRow, error) {
	rows, err := q.db.Query(ctx, getAllBlogs, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetAllBlogsRow
	for rows.Next() {
		var i GetAllBlogsRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBlogAIHistory = `-- name: GetBlogAIHistory :many
SELECT id, blog_id, prompt, phan_hoi_ai, mo_hinh_ai, so_luong_token, ngay_tao FROM lich_su_ai_blog
WHERE blog_id = $1
ORDER BY ngay_tao DESC
`

func (q *Queries) GetBlogAIHistory(ctx context.Context, blogID *int32) ([]LichSuAiBlog, error) {
	rows, err := q.db.Query(ctx, getBlogAIHistory, blogID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []LichSuAiBlog
	for rows.Next() {
		var i LichSuAiBlog
		if err := rows.Scan(
			&i.ID,
			&i.BlogID,
			&i.Prompt,
			&i.PhanHoiAi,
			&i.MoHinhAi,
			&i.SoLuongToken,
			&i.NgayTao,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBlogByID = `-- name: GetBlogByID :one
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.id = $1
`

type GetBlogByIDRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetBlogByID(ctx context.Context, id int32) (GetBlogByIDRow, error) {
	row := q.db.QueryRow(ctx, getBlogByID, id)
	var i GetBlogByIDRow
	err := row.Scan(
		&i.ID,
		&i.TieuDe,
		&i.Slug,
		&i.TomTat,
		&i.NoiDung,
		&i.AnhDaiDien,
		&i.TacGiaID,
		&i.DanhMuc,
		&i.TuKhoa,
		&i.LuotXem,
		&i.LuotThich,
		&i.TrangThai,
		&i.NoiBat,
		&i.NgayDang,
		&i.NgayTao,
		&i.NgayCapNhat,
		&i.TenTacGia,
		&i.EmailTacGia,
	)
	return i, err
}

const getBlogBySlug = `-- name: GetBlogBySlug :one
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.slug = $1
`

type GetBlogBySlugRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetBlogBySlug(ctx context.Context, slug string) (GetBlogBySlugRow, error) {
	row := q.db.QueryRow(ctx, getBlogBySlug, slug)
	var i GetBlogBySlugRow
	err := row.Scan(
		&i.ID,
		&i.TieuDe,
		&i.Slug,
		&i.TomTat,
		&i.NoiDung,
		&i.AnhDaiDien,
		&i.TacGiaID,
		&i.DanhMuc,
		&i.TuKhoa,
		&i.LuotXem,
		&i.LuotThich,
		&i.TrangThai,
		&i.NoiBat,
		&i.NgayDang,
		&i.NgayTao,
		&i.NgayCapNhat,
		&i.TenTacGia,
		&i.EmailTacGia,
	)
	return i, err
}

const getBlogCommentReplies = `-- name: GetBlogCommentReplies :many
SELECT 
    bl.id, bl.blog_id, bl.nguoi_dung_id, bl.noi_dung, bl.binh_luan_cha_id, bl.da_duyet, bl.ngay_tao, bl.ngay_cap_nhat,
    nd.ho_ten AS ten_nguoi_dung,
    nd.email AS email_nguoi_dung
FROM binh_luan_blog bl
LEFT JOIN nguoi_dung nd ON bl.nguoi_dung_id = nd.id
WHERE bl.binh_luan_cha_id = $1
    AND bl.da_duyet = TRUE
ORDER BY bl.ngay_tao ASC
`

type GetBlogCommentRepliesRow struct {
	ID             int32            `json:"id"`
	BlogID         int32            `json:"blog_id"`
	NguoiDungID    pgtype.UUID      `json:"nguoi_dung_id"`
	NoiDung        string           `json:"noi_dung"`
	BinhLuanChaID  *int32           `json:"binh_luan_cha_id"`
	DaDuyet        *bool            `json:"da_duyet"`
	NgayTao        pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat    pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenNguoiDung   *string          `json:"ten_nguoi_dung"`
	EmailNguoiDung *string          `json:"email_nguoi_dung"`
}

func (q *Queries) GetBlogCommentReplies(ctx context.Context, binhLuanChaID *int32) ([]GetBlogCommentRepliesRow, error) {
	rows, err := q.db.Query(ctx, getBlogCommentReplies, binhLuanChaID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetBlogCommentRepliesRow
	for rows.Next() {
		var i GetBlogCommentRepliesRow
		if err := rows.Scan(
			&i.ID,
			&i.BlogID,
			&i.NguoiDungID,
			&i.NoiDung,
			&i.BinhLuanChaID,
			&i.DaDuyet,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenNguoiDung,
			&i.EmailNguoiDung,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBlogComments = `-- name: GetBlogComments :many
SELECT 
    bl.id, bl.blog_id, bl.nguoi_dung_id, bl.noi_dung, bl.binh_luan_cha_id, bl.da_duyet, bl.ngay_tao, bl.ngay_cap_nhat,
    nd.ho_ten AS ten_nguoi_dung,
    nd.email AS email_nguoi_dung
FROM binh_luan_blog bl
LEFT JOIN nguoi_dung nd ON bl.nguoi_dung_id = nd.id
WHERE bl.blog_id = $1
    AND bl.da_duyet = TRUE
    AND bl.binh_luan_cha_id IS NULL -- Chỉ lấy comment gốc
ORDER BY bl.ngay_tao DESC
LIMIT $2 OFFSET $3
`

type GetBlogCommentsParams struct {
	BlogID int32 `json:"blog_id"`
	Limit  int32 `json:"limit"`
	Offset int32 `json:"offset"`
}

type GetBlogCommentsRow struct {
	ID             int32            `json:"id"`
	BlogID         int32            `json:"blog_id"`
	NguoiDungID    pgtype.UUID      `json:"nguoi_dung_id"`
	NoiDung        string           `json:"noi_dung"`
	BinhLuanChaID  *int32           `json:"binh_luan_cha_id"`
	DaDuyet        *bool            `json:"da_duyet"`
	NgayTao        pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat    pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenNguoiDung   *string          `json:"ten_nguoi_dung"`
	EmailNguoiDung *string          `json:"email_nguoi_dung"`
}

func (q *Queries) GetBlogComments(ctx context.Context, arg GetBlogCommentsParams) ([]GetBlogCommentsRow, error) {
	rows, err := q.db.Query(ctx, getBlogComments, arg.BlogID, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetBlogCommentsRow
	for rows.Next() {
		var i GetBlogCommentsRow
		if err := rows.Scan(
			&i.ID,
			&i.BlogID,
			&i.NguoiDungID,
			&i.NoiDung,
			&i.BinhLuanChaID,
			&i.DaDuyet,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenNguoiDung,
			&i.EmailNguoiDung,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBlogStats = `-- name: GetBlogStats :one
SELECT 
    COUNT(*) FILTER (WHERE trang_thai = 'cong_bo') AS tong_so_da_dang,
    COUNT(*) FILTER (WHERE trang_thai = 'nhap') AS tong_so_nhap,
    COUNT(*) FILTER (WHERE trang_thai = 'luu_tru') AS tong_so_luu_tru,
    COUNT(*) FILTER (WHERE noi_bat = TRUE) AS tong_so_noi_bat,
    SUM(luot_xem) AS tong_luot_xem,
    SUM(luot_thich) AS tong_luot_thich,
    COUNT(*) FILTER (WHERE ngay_dang >= NOW() - INTERVAL '30 days') AS so_bai_trong_30_ngay
FROM blog
`

type GetBlogStatsRow struct {
	TongSoDaDang     int64 `json:"tong_so_da_dang"`
	TongSoNhap       int64 `json:"tong_so_nhap"`
	TongSoLuuTru     int64 `json:"tong_so_luu_tru"`
	TongSoNoiBat     int64 `json:"tong_so_noi_bat"`
	TongLuotXem      int64 `json:"tong_luot_xem"`
	TongLuotThich    int64 `json:"tong_luot_thich"`
	SoBaiTrong30Ngay int64 `json:"so_bai_trong_30_ngay"`
}

func (q *Queries) GetBlogStats(ctx context.Context) (GetBlogStatsRow, error) {
	row := q.db.QueryRow(ctx, getBlogStats)
	var i GetBlogStatsRow
	err := row.Scan(
		&i.TongSoDaDang,
		&i.TongSoNhap,
		&i.TongSoLuuTru,
		&i.TongSoNoiBat,
		&i.TongLuotXem,
		&i.TongLuotThich,
		&i.SoBaiTrong30Ngay,
	)
	return i, err
}

const getBlogsByAuthor = `-- name: GetBlogsByAuthor :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.tac_gia_id = $1
ORDER BY COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $2 OFFSET $3
`

type GetBlogsByAuthorParams struct {
	TacGiaID pgtype.UUID `json:"tac_gia_id"`
	Limit    int32       `json:"limit"`
	Offset   int32       `json:"offset"`
}

type GetBlogsByAuthorRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetBlogsByAuthor(ctx context.Context, arg GetBlogsByAuthorParams) ([]GetBlogsByAuthorRow, error) {
	rows, err := q.db.Query(ctx, getBlogsByAuthor, arg.TacGiaID, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetBlogsByAuthorRow
	for rows.Next() {
		var i GetBlogsByAuthorRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getBlogsByCategory = `-- name: GetBlogsByCategory :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.danh_muc = $1
    AND b.trang_thai = 'cong_bo'
    AND (b.ngay_dang IS NULL OR b.ngay_dang <= NOW())
ORDER BY 
    CASE WHEN b.noi_bat = TRUE THEN 0 ELSE 1 END,
    COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $2 OFFSET $3
`

type GetBlogsByCategoryParams struct {
	DanhMuc *string `json:"danh_muc"`
	Limit   int32   `json:"limit"`
	Offset  int32   `json:"offset"`
}

type GetBlogsByCategoryRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetBlogsByCategory(ctx context.Context, arg GetBlogsByCategoryParams) ([]GetBlogsByCategoryRow, error) {
	rows, err := q.db.Query(ctx, getBlogsByCategory, arg.DanhMuc, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetBlogsByCategoryRow
	for rows.Next() {
		var i GetBlogsByCategoryRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getFeaturedBlogs = `-- name: GetFeaturedBlogs :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.noi_bat = TRUE
    AND b.trang_thai = 'cong_bo'
    AND (b.ngay_dang IS NULL OR b.ngay_dang <= NOW())
ORDER BY COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $1
`

type GetFeaturedBlogsRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetFeaturedBlogs(ctx context.Context, limit int32) ([]GetFeaturedBlogsRow, error) {
	rows, err := q.db.Query(ctx, getFeaturedBlogs, limit)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetFeaturedBlogsRow
	for rows.Next() {
		var i GetFeaturedBlogsRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getPendingComments = `-- name: GetPendingComments :many
SELECT 
    bl.id, bl.blog_id, bl.nguoi_dung_id, bl.noi_dung, bl.binh_luan_cha_id, bl.da_duyet, bl.ngay_tao, bl.ngay_cap_nhat,
    nd.ho_ten AS ten_nguoi_dung,
    nd.email AS email_nguoi_dung,
    b.tieu_de AS ten_blog
FROM binh_luan_blog bl
LEFT JOIN nguoi_dung nd ON bl.nguoi_dung_id = nd.id
LEFT JOIN blog b ON bl.blog_id = b.id
WHERE bl.da_duyet = FALSE
ORDER BY bl.ngay_tao DESC
LIMIT $1 OFFSET $2
`

type GetPendingCommentsParams struct {
	Limit  int32 `json:"limit"`
	Offset int32 `json:"offset"`
}

type GetPendingCommentsRow struct {
	ID             int32            `json:"id"`
	BlogID         int32            `json:"blog_id"`
	NguoiDungID    pgtype.UUID      `json:"nguoi_dung_id"`
	NoiDung        string           `json:"noi_dung"`
	BinhLuanChaID  *int32           `json:"binh_luan_cha_id"`
	DaDuyet        *bool            `json:"da_duyet"`
	NgayTao        pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat    pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenNguoiDung   *string          `json:"ten_nguoi_dung"`
	EmailNguoiDung *string          `json:"email_nguoi_dung"`
	TenBlog        *string          `json:"ten_blog"`
}

func (q *Queries) GetPendingComments(ctx context.Context, arg GetPendingCommentsParams) ([]GetPendingCommentsRow, error) {
	rows, err := q.db.Query(ctx, getPendingComments, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetPendingCommentsRow
	for rows.Next() {
		var i GetPendingCommentsRow
		if err := rows.Scan(
			&i.ID,
			&i.BlogID,
			&i.NguoiDungID,
			&i.NoiDung,
			&i.BinhLuanChaID,
			&i.DaDuyet,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenNguoiDung,
			&i.EmailNguoiDung,
			&i.TenBlog,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getPublishedBlogs = `-- name: GetPublishedBlogs :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.trang_thai = 'cong_bo'
    AND (b.ngay_dang IS NULL OR b.ngay_dang <= NOW())
ORDER BY 
    CASE WHEN b.noi_bat = TRUE THEN 0 ELSE 1 END,
    COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $1 OFFSET $2
`

type GetPublishedBlogsParams struct {
	Limit  int32 `json:"limit"`
	Offset int32 `json:"offset"`
}

type GetPublishedBlogsRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetPublishedBlogs(ctx context.Context, arg GetPublishedBlogsParams) ([]GetPublishedBlogsRow, error) {
	rows, err := q.db.Query(ctx, getPublishedBlogs, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetPublishedBlogsRow
	for rows.Next() {
		var i GetPublishedBlogsRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getRelatedBlogs = `-- name: GetRelatedBlogs :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.id != $1
    AND b.trang_thai = 'cong_bo'
    AND (b.ngay_dang IS NULL OR b.ngay_dang <= NOW())
    AND (
        b.danh_muc = (SELECT danh_muc FROM blog WHERE id = $1)
        OR b.tu_khoa && (SELECT tu_khoa FROM blog WHERE id = $1)
    )
ORDER BY COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $2
`

type GetRelatedBlogsParams struct {
	ID    int32 `json:"id"`
	Limit int32 `json:"limit"`
}

type GetRelatedBlogsRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
}

func (q *Queries) GetRelatedBlogs(ctx context.Context, arg GetRelatedBlogsParams) ([]GetRelatedBlogsRow, error) {
	rows, err := q.db.Query(ctx, getRelatedBlogs, arg.ID, arg.Limit)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetRelatedBlogsRow
	for rows.Next() {
		var i GetRelatedBlogsRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const incrementBlogLikes = `-- name: IncrementBlogLikes :exec
UPDATE blog
SET luot_thich = luot_thich + 1
WHERE id = $1
`

func (q *Queries) IncrementBlogLikes(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, incrementBlogLikes, id)
	return err
}

const incrementBlogViews = `-- name: IncrementBlogViews :exec
UPDATE blog
SET luot_xem = luot_xem + 1
WHERE id = $1
`

func (q *Queries) IncrementBlogViews(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, incrementBlogViews, id)
	return err
}

const searchBlogs = `-- name: SearchBlogs :many
SELECT 
    b.id, b.tieu_de, b.slug, b.tom_tat, b.noi_dung, b.anh_dai_dien, b.tac_gia_id, b.danh_muc, b.tu_khoa, b.luot_xem, b.luot_thich, b.trang_thai, b.noi_bat, b.ngay_dang, b.ngay_tao, b.ngay_cap_nhat,
    nd.ho_ten AS ten_tac_gia,
    nd.email AS email_tac_gia,
    ts_rank(
        to_tsvector('vietnamese', COALESCE(b.tieu_de, '') || ' ' || COALESCE(b.tom_tat, '') || ' ' || COALESCE(b.noi_dung, '')),
        plainto_tsquery('vietnamese', $1)
    ) AS rank
FROM blog b
LEFT JOIN nguoi_dung nd ON b.tac_gia_id = nd.id
WHERE b.trang_thai = 'cong_bo'
    AND (b.ngay_dang IS NULL OR b.ngay_dang <= NOW())
    AND (
        to_tsvector('vietnamese', COALESCE(b.tieu_de, '') || ' ' || COALESCE(b.tom_tat, '') || ' ' || COALESCE(b.noi_dung, '')) 
        @@ plainto_tsquery('vietnamese', $1)
        OR b.tieu_de ILIKE '%' || $1 || '%'
        OR b.tom_tat ILIKE '%' || $1 || '%'
    )
ORDER BY rank DESC, COALESCE(b.ngay_dang, b.ngay_tao) DESC
LIMIT $2 OFFSET $3
`

type SearchBlogsParams struct {
	PlaintoTsquery string `json:"plainto_tsquery"`
	Limit          int32  `json:"limit"`
	Offset         int32  `json:"offset"`
}

type SearchBlogsRow struct {
	ID          int32            `json:"id"`
	TieuDe      string           `json:"tieu_de"`
	Slug        string           `json:"slug"`
	TomTat      *string          `json:"tom_tat"`
	NoiDung     string           `json:"noi_dung"`
	AnhDaiDien  *string          `json:"anh_dai_dien"`
	TacGiaID    pgtype.UUID      `json:"tac_gia_id"`
	DanhMuc     *string          `json:"danh_muc"`
	TuKhoa      []string         `json:"tu_khoa"`
	LuotXem     *int32           `json:"luot_xem"`
	LuotThich   *int32           `json:"luot_thich"`
	TrangThai   *string          `json:"trang_thai"`
	NoiBat      *bool            `json:"noi_bat"`
	NgayDang    pgtype.Timestamp `json:"ngay_dang"`
	NgayTao     pgtype.Timestamp `json:"ngay_tao"`
	NgayCapNhat pgtype.Timestamp `json:"ngay_cap_nhat"`
	TenTacGia   *string          `json:"ten_tac_gia"`
	EmailTacGia *string          `json:"email_tac_gia"`
	Rank        float32          `json:"rank"`
}

func (q *Queries) SearchBlogs(ctx context.Context, arg SearchBlogsParams) ([]SearchBlogsRow, error) {
	rows, err := q.db.Query(ctx, searchBlogs, arg.PlaintoTsquery, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []SearchBlogsRow
	for rows.Next() {
		var i SearchBlogsRow
		if err := rows.Scan(
			&i.ID,
			&i.TieuDe,
			&i.Slug,
			&i.TomTat,
			&i.NoiDung,
			&i.AnhDaiDien,
			&i.TacGiaID,
			&i.DanhMuc,
			&i.TuKhoa,
			&i.LuotXem,
			&i.LuotThich,
			&i.TrangThai,
			&i.NoiBat,
			&i.NgayDang,
			&i.NgayTao,
			&i.NgayCapNhat,
			&i.TenTacGia,
			&i.EmailTacGia,
			&i.Rank,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateBlog = `-- name: UpdateBlog :one
UPDATE blog
SET 
    tieu_de = COALESCE($2, tieu_de),
    slug = COALESCE($3, slug),
    tom_tat = COALESCE($4, tom_tat),
    noi_dung = COALESCE($5, noi_dung),
    anh_dai_dien = COALESCE($6, anh_dai_dien),
    danh_muc = COALESCE($7, danh_muc),
    tu_khoa = COALESCE($8, tu_khoa),
    trang_thai = COALESCE($9, trang_thai),
    noi_bat = COALESCE($10, noi_bat),
    ngay_dang = COALESCE($11, ngay_dang),
    ngay_cap_nhat = NOW()
WHERE id = $1
RETURNING id, tieu_de, slug, tom_tat, noi_dung, anh_dai_dien, tac_gia_id, danh_muc, tu_khoa, luot_xem, luot_thich, trang_thai, noi_bat, ngay_dang, ngay_tao, ngay_cap_nhat
`

type UpdateBlogParams struct {
	ID         int32            `json:"id"`
	TieuDe     string           `json:"tieu_de"`
	Slug       string           `json:"slug"`
	TomTat     *string          `json:"tom_tat"`
	NoiDung    string           `json:"noi_dung"`
	AnhDaiDien *string          `json:"anh_dai_dien"`
	DanhMuc    *string          `json:"danh_muc"`
	TuKhoa     []string         `json:"tu_khoa"`
	TrangThai  *string          `json:"trang_thai"`
	NoiBat     *bool            `json:"noi_bat"`
	NgayDang   pgtype.Timestamp `json:"ngay_dang"`
}

func (q *Queries) UpdateBlog(ctx context.Context, arg UpdateBlogParams) (Blog, error) {
	row := q.db.QueryRow(ctx, updateBlog,
		arg.ID,
		arg.TieuDe,
		arg.Slug,
		arg.TomTat,
		arg.NoiDung,
		arg.AnhDaiDien,
		arg.DanhMuc,
		arg.TuKhoa,
		arg.TrangThai,
		arg.NoiBat,
		arg.NgayDang,
	)
	var i Blog
	err := row.Scan(
		&i.ID,
		&i.TieuDe,
		&i.Slug,
		&i.TomTat,
		&i.NoiDung,
		&i.AnhDaiDien,
		&i.TacGiaID,
		&i.DanhMuc,
		&i.TuKhoa,
		&i.LuotXem,
		&i.LuotThich,
		&i.TrangThai,
		&i.NoiBat,
		&i.NgayDang,
		&i.NgayTao,
		&i.NgayCapNhat,
	)
	return i, err
}
